<rdf:RDF
 xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
 xmlns:z="http://www.zotero.org/namespaces/export#"
 xmlns:dc="http://purl.org/dc/elements/1.1/"
 xmlns:link="http://purl.org/rss/1.0/modules/link/">
    <z:Attachment rdf:about="#item_30">
        <z:itemType>attachment</z:itemType>
        <rdf:resource rdf:resource="/Users/lillyli/Documents/æå/SNA/SNscript.R"/>
        <dc:title>SNscript.R</dc:title>
        <z:linkMode>2</z:linkMode>
        <link:type>text/plain</link:type>
        <dc:description>&lt;p&gt;Assignment2&lt;/p&gt;
&lt;p&gt;Our course is in the central and then there is a cluster of the students who take HUDK4054. The central person is the the student Joonyoung_Park.&lt;/p&gt;
&lt;p&gt;script&lt;/p&gt;
&lt;p&gt;library(tidyr, dplyr)&lt;br /&gt;library(igraph)&lt;br /&gt;&lt;br /&gt;K1 &amp;lt;- read.table(&quot;hudk4050-classes.csv&quot;, sep = &quot;,&quot;, header = TRUE)&lt;br /&gt;K2&amp;lt;- tidyr::unite(K1, studentName,First.name, Last.name)&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;K2$studentName &amp;lt;- as.factor(K2$studentName)&lt;br /&gt;K3 &amp;lt;- tidyr::gather(K2,studentName,courseN)&lt;br /&gt;names(K3) &amp;lt;- c(&quot;studentName&quot;,&quot;courseN&quot;,&quot;courseName&quot;)&lt;br /&gt;&lt;br /&gt;K4 &amp;lt;- dplyr::select(K3, courseName, studentName)&lt;br /&gt;K5 &amp;lt;- dplyr::filter(K4, courseName!=&quot;HUDK4050&quot;)&lt;br /&gt;newEDGE &amp;lt;- dplyr::count(K5, courseName, studentName)&lt;br /&gt;newEDGE = dplyr::filter(newEDGE, courseName!=&quot;&quot;)&lt;br /&gt;names(newEDGE) &amp;lt;- c(&quot;from&quot;, &quot;to&quot;, &quot;count&quot;)&lt;br /&gt;&lt;br /&gt;course &amp;lt;- dplyr::select(K5, courseName)&lt;br /&gt;course &amp;lt;- unique(course)&lt;br /&gt;course &amp;lt;- dplyr::arrange(course, courseName)&lt;br /&gt;course &amp;lt;- dplyr::filter(course, courseName!=&quot;&quot;)&lt;br /&gt;course$group &amp;lt;- &quot;course&quot;&lt;br /&gt;&lt;br /&gt;studentNew &amp;lt;- dplyr::select(K3, studentName)&lt;br /&gt;studentNew &amp;lt;- unique(studentNew)&lt;br /&gt;studentNew$group &amp;lt;- &quot;studentNew&quot;&lt;br /&gt;&lt;br /&gt;names(course) &amp;lt;- c(&quot;id&quot;,&amp;nbsp; &quot;group&quot;)&lt;br /&gt;names(studentNew) &amp;lt;- c(&quot;id&quot;, &quot;group&quot;)&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;VERTEXNew &amp;lt;- dplyr::bind_rows(studentNew, course)&lt;br /&gt;g &amp;lt;- graph.data.frame(newEDGE, directed=TRUE, vertices=VERTEXNew)&lt;br /&gt;plot(g,layout=layout.fruchterman.reingold)&lt;br /&gt;&lt;br /&gt;edge.arrow.size=20&lt;br /&gt;vertex.label=NA&lt;br /&gt;vertex.size=5&lt;br /&gt;plot(g,layout=layout.fruchterman.reingold)&lt;br /&gt;&lt;br /&gt;#following the code in revere.R&lt;br /&gt;K6 &amp;lt;- dplyr::filter(K5, courseName!=&quot;&quot;)&lt;br /&gt;K7 &amp;lt;- table(K6)&lt;br /&gt;&lt;br /&gt;course.net &amp;lt;- K7 %*% t(K7)&lt;br /&gt;student.net &amp;lt;- t(K7) %*% K7&lt;br /&gt;&lt;br /&gt;diag(course.net) &amp;lt;- NA&lt;br /&gt;diag(student.net) &amp;lt;- NA&lt;br /&gt;&lt;br /&gt;course.g &amp;lt;- graph.adjacency(course.net,mode=&quot;undirected&quot;, weighted=NULL, diag=FALSE)&lt;br /&gt;student.g &amp;lt;- graph.adjacency(student.net, weighted=TRUE, mode=&quot;undirected&quot;, diag=FALSE)&lt;br /&gt;&lt;br /&gt;la &amp;lt;- layout.fruchterman.reingold(student.g)&lt;br /&gt;e.wt &amp;lt;- get.edge.attribute(student.g, &quot;weight&quot;)&lt;br /&gt;&lt;br /&gt;pdf(file=&quot;student-view.pdf&quot;, width=10, height=10)&lt;br /&gt;plot(student.g, layout=la, vertex.size=15,edge.width=e.wt,vertex.label=V(student.g)$name)&lt;br /&gt;dev.off()&lt;br /&gt;&lt;br /&gt;png(file=&quot;student-view.png&quot;, width=1000, height=1000, res=150)&lt;br /&gt;plot(student.g, layout=la, vertex.size=15,edge.width=e.wt,&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; vertex.label=V(student.g)$name)&lt;br /&gt;dev.off()&lt;br /&gt;&lt;br /&gt;pdf(file=&quot;course-view.pdf&quot;, width=22, height=17,pointsize=8)&lt;br /&gt;&lt;br /&gt;la &amp;lt;- layout.fruchterman.reingold(course.g)&lt;br /&gt;e.wt &amp;lt;- get.edge.attribute(course.g, &quot;weight&quot;)&lt;br /&gt;&lt;br /&gt;plot(course.g, layout=la, vertex.size=3,edge.width=0.1,&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; vertex.label=V(course.g)$name)&lt;br /&gt;dev.off()&lt;br /&gt;&lt;br /&gt;png(file=&quot;course-view.png&quot;, width=2200, height=1700, res=150)&lt;br /&gt;&lt;br /&gt;la &amp;lt;- layout.fruchterman.reingold(course.g)&lt;br /&gt;e.wt &amp;lt;- get.edge.attribute(course.g, &quot;weight&quot;)&lt;br /&gt;&lt;br /&gt;plot(course.g, layout=la, vertex.size=3,edge.width=0.1,&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; vertex.label=V(course.g)$name)&lt;br /&gt;dev.off()&lt;br /&gt;&lt;br /&gt;#course.net &amp;lt;- K7 %*% t(K7) before = case 1. person.net &amp;lt;- data %*% t(data) 2.person2.net &amp;lt;- data %*% t(data)&lt;br /&gt;K7.t &amp;lt;- t(K7)&lt;br /&gt;course2.net &amp;lt;- K7 %*% t(K7)&lt;br /&gt;student2.net &amp;lt;- t(K7) %*% K7&lt;br /&gt;&lt;br /&gt;diag(course2.net) &amp;lt;- NA&lt;br /&gt;diag(student2.net) &amp;lt;- NA&lt;br /&gt;&lt;br /&gt;course2.g &amp;lt;- graph.adjacency(course2.net, mode=&quot;undirected&quot;, weighted=TRUE, diag=FALSE)&lt;br /&gt;student2.g &amp;lt;- graph.adjacency(student2.net, weighted=NULL, mode=&quot;undirected&quot;, diag=FALSE)&lt;br /&gt;&lt;br /&gt;la &amp;lt;- layout.fruchterman.reingold(student2.g)&lt;br /&gt;e.wt &amp;lt;- get.edge.attribute(student2.g, &quot;weight&quot;)&lt;br /&gt;&lt;br /&gt;pdf(file=&quot;student-weighted-view.pdf&quot;, width=20, height=20)&lt;br /&gt;plot(student2.g, layout=la, vertex.size=15,edge.width=e.wt,&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; vertex.label=V(student2.g)$name)&lt;br /&gt;dev.off()&lt;br /&gt;&lt;br /&gt;png(file=&quot;student2-weighted-view.png&quot;, width=2000, height=2000, res=150)&lt;br /&gt;plot(student2.g, layout=la, vertex.size=15,edge.width=e.wt,&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; vertex.label=V(student2.g)$name)&lt;br /&gt;dev.off()&lt;br /&gt;&lt;br /&gt;### Centrality&lt;br /&gt;&lt;br /&gt;## Betweenness&lt;br /&gt;btwn.student &amp;lt;- betweenness(student.g)&lt;br /&gt;names(btwn.student) &amp;lt;- V(student.g)$name&lt;br /&gt;ind &amp;lt;- order(-btwn.student)&lt;br /&gt;btwn.student[ind][1:10]&lt;br /&gt;&lt;br /&gt;## Eigenvector&lt;br /&gt;cent.eig &amp;lt;- evcent(student.g)&lt;br /&gt;names(cent.eig$vector) &amp;lt;- V(student.g)$name&lt;br /&gt;&lt;br /&gt;ind &amp;lt;- order(-cent.eig$vector)&lt;br /&gt;cent.eig$vector[ind][1:10]&lt;br /&gt;&lt;br /&gt;#cent.eig$vector[ind][1:10]&lt;br /&gt;#David_Cody&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Devan_Goto&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Jie_Gao&amp;nbsp;&amp;nbsp;&amp;nbsp; Jingtong_Feng&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Chuheng_Hu &lt;br /&gt;#1.0000000&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 1.0000000&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 1.0000000&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 0.9194821&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 0.8816590 &lt;br /&gt;#Samantha_Pepe&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Shreya_Goel Jonathan_Stelman&amp;nbsp;&amp;nbsp; Joshua_Coleman&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Zhuqian_Zhou &lt;br /&gt;#0.8816590&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 0.6375686&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 0.5797423&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 0.5797423&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 0.5797423 &lt;br /&gt;&lt;br /&gt;cent.eig &amp;lt;- evcent(course.g)&lt;br /&gt;names(cent.eig$vector) &amp;lt;- V(course.g)$name&lt;br /&gt;ind &amp;lt;- order(-cent.eig$vector)&lt;br /&gt;cent.eig$vector[ind][1:10]&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;#cent.eig$vector[ind][1:10]&lt;br /&gt;#HUDK4054&amp;nbsp; HUDK4029&amp;nbsp; ITSF4010&amp;nbsp; HUDM5059&amp;nbsp; HUDK5059&amp;nbsp; HUDM5123&amp;nbsp; HUDK4049&amp;nbsp; HUDK5030&amp;nbsp; HUDM5122&amp;nbsp; MSTU4001 &lt;br /&gt;#1.0000000 0.9173929 0.6149128 0.3270369 0.2049709 0.2049709 0.1418614 0.1196965 0.1196965 0.1196965 &lt;br /&gt;&lt;br /&gt;## Kleinberg authority&lt;br /&gt;cent.klein &amp;lt;- authority.score(student.g)&lt;br /&gt;names(cent.klein$vector) &amp;lt;- V(student.g)$name&lt;br /&gt;ind &amp;lt;- order(-cent.klein$vector)&lt;br /&gt;cent.klein$vector[ind][1:10]&lt;br /&gt;&lt;br /&gt;#&amp;gt; cent.klein$vector[ind][1:10]&lt;br /&gt;#David_Cody&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Devan_Goto&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Jie_Gao&amp;nbsp;&amp;nbsp;&amp;nbsp; Jingtong_Feng&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Chuheng_Hu &lt;br /&gt;#1.0000000&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 1.0000000&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 1.0000000&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 0.9193911&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 0.8816692 &lt;br /&gt;#Samantha_Pepe&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Shreya_Goel Jonathan_Stelman&amp;nbsp;&amp;nbsp; Joshua_Coleman&amp;nbsp;&amp;nbsp;&amp;nbsp; Lauren_Romine &lt;br /&gt;#0.8816692&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 0.6375663&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 0.5797494&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 0.5797494&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 0.5797494 &lt;br /&gt;&lt;br /&gt;&lt;br /&gt;pdf(file=&quot;student-network-reduced.pdf&quot;, width=22, height=17,pointsize=8)&lt;br /&gt;student.g.copy &amp;lt;- student.g&lt;br /&gt;la &amp;lt;- layout.fruchterman.reingold(student.g.copy)&lt;br /&gt;plot(student.g.copy, layout=la, vertex.size=3,vertex.label=V(student.g.copy)$name)&lt;br /&gt;dev.off()&lt;br /&gt;&lt;br /&gt;png(file=&quot;student-network-reduced.png&quot;, width=2200, height=1700, res=140)&lt;br /&gt;student.g.copy &amp;lt;- student.g&lt;br /&gt;la &amp;lt;- layout.fruchterman.reingold(student.g.copy)&lt;br /&gt;plot(student.g.copy, layout=la, vertex.size=3,vertex.label=V(student.g.copy)$name)&lt;br /&gt;dev.off()&lt;br /&gt;&lt;br /&gt;png(file=&quot;test.png&quot;, width=2000, height=1000)&lt;br /&gt;lay &amp;lt;- layout.fruchterman.reingold(student.g)&lt;br /&gt;pr.id &amp;lt;- 200&lt;br /&gt;# Plot the eigevector and betweenness centrality&lt;br /&gt;par(mfrow=c(1,2))&lt;br /&gt;plot(bonpow(student.g, exponent=1), betweenness(student.g))&lt;br /&gt;&lt;br /&gt;e.rank &amp;lt;- rank(-evcent(student.g)$vector)&lt;br /&gt;b.rank &amp;lt;- rank(-betweenness(student.g))&lt;br /&gt;c.rank &amp;lt;- rank(-bonpow(student.g, exponent=1))&lt;br /&gt;s.top &amp;lt;- c.rank &amp;lt; 10 | b.rank &amp;lt; 10&lt;br /&gt;text(bonpow(student.g)[s.top], betweenness(student.g)[s.top], cex=0.6, pos=4, labels=V(student.g)$name[s.top])&lt;br /&gt;V(student.g)[pr.id]$color &amp;lt;- &quot;yellow&quot;&lt;br /&gt;E(student.g)$color=&quot;grey95&quot;&lt;br /&gt;plot(student.g, layout=lay, vertex.size=2,vertex.label.cex=0.6, vertex.label=V(student.g)$name)&lt;br /&gt;dev.off()&lt;/p&gt;</dc:description>
    </z:Attachment>
</rdf:RDF>
